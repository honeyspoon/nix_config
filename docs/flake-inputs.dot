// Flake Input Dependencies
// Generate with: dot -Tsvg docs/flake-inputs.dot -o docs/flake-inputs.svg

digraph FlakeInputs {
    graph [
        rankdir=TB
        bgcolor="#1a1b26"
        fontcolor="#a9b1d6"
        fontname="JetBrains Mono"
        pad=0.5
        nodesep=0.5
        ranksep=0.8
    ];

    node [
        shape=box
        style="rounded,filled"
        fontname="JetBrains Mono"
        fontsize=10
    ];

    edge [
        color="#565f89"
        fontcolor="#565f89"
        fontname="JetBrains Mono"
        fontsize=8
    ];

    // Main nixpkgs (hub)
    nixpkgs [
        label="nixpkgs\n(25.11-darwin)"
        fillcolor="#7aa2f7"
        fontcolor="#1a1b26"
    ];

    // Flake infrastructure
    subgraph cluster_infra {
        label="Infrastructure"
        fontcolor="#bb9af7"
        color="#bb9af7"
        style=dashed

        flake_parts [label="flake-parts" fillcolor="#24283b" fontcolor="#a9b1d6"];
        git_hooks [label="git-hooks.nix" fillcolor="#24283b" fontcolor="#a9b1d6"];
        treefmt [label="treefmt-nix" fillcolor="#24283b" fontcolor="#a9b1d6"];
    }

    // System configuration
    subgraph cluster_system {
        label="System Config"
        fontcolor="#f7768e"
        color="#f7768e"
        style=dashed

        nix_darwin [label="nix-darwin" fillcolor="#24283b" fontcolor="#a9b1d6"];
        home_manager [label="home-manager" fillcolor="#24283b" fontcolor="#a9b1d6"];
        sops_nix [label="sops-nix" fillcolor="#24283b" fontcolor="#a9b1d6"];
    }

    // Tools & themes
    subgraph cluster_tools {
        label="Tools & Theming"
        fontcolor="#9ece6a"
        color="#9ece6a"
        style=dashed

        rust_overlay [label="rust-overlay" fillcolor="#24283b" fontcolor="#a9b1d6"];
        stylix [label="stylix" fillcolor="#24283b" fontcolor="#a9b1d6"];
        nix_index [label="nix-index-database" fillcolor="#24283b" fontcolor="#a9b1d6"];
    }

    // Browser & addons
    subgraph cluster_browser {
        label="Browser"
        fontcolor="#e0af68"
        color="#e0af68"
        style=dashed

        zen_browser [label="zen-browser" fillcolor="#24283b" fontcolor="#a9b1d6"];
        firefox_addons [label="firefox-addons" fillcolor="#24283b" fontcolor="#a9b1d6"];
    }

    // Non-flake sources
    subgraph cluster_sources {
        label="Non-Flake Sources"
        fontcolor="#73daca"
        color="#73daca"
        style=dashed

        agent_browser [label="agent-browser\n(source)" fillcolor="#414868" fontcolor="#a9b1d6" style="rounded,filled,dashed"];
        skill_react [label="skill-react-best-practices\n(source)" fillcolor="#414868" fontcolor="#a9b1d6" style="rounded,filled,dashed"];
        opencode_notify [label="opencode-notify\n(source)" fillcolor="#414868" fontcolor="#a9b1d6" style="rounded,filled,dashed"];
        opencode_mystatus [label="opencode-mystatus\n(source)" fillcolor="#414868" fontcolor="#a9b1d6" style="rounded,filled,dashed"];
    }

    // Dependencies (follows = nixpkgs)
    nix_darwin -> nixpkgs [label="follows" style=dashed];
    home_manager -> nixpkgs [label="follows" style=dashed];
    sops_nix -> nixpkgs [label="follows" style=dashed];
    rust_overlay -> nixpkgs [label="follows" style=dashed];
    stylix -> nixpkgs [label="follows" style=dashed];
    nix_index -> nixpkgs [label="follows" style=dashed];
    zen_browser -> nixpkgs [label="follows" style=dashed];
    zen_browser -> home_manager [label="follows" style=dashed];
    firefox_addons -> nixpkgs [label="follows" style=dashed];
    git_hooks -> nixpkgs [label="follows" style=dashed];
    treefmt -> nixpkgs [label="follows" style=dashed];
}
